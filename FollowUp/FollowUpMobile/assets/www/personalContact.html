<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title></title>


    <link rel="stylesheet" href="https://d10ajoocuyu32n.cloudfront.net/mobile/1.3.1/jquery.mobile-1.3.1.min.css">

    <!-- Extra Codiqa features -->
    <link rel="stylesheet" href="codiqa.ext.css">

    <!-- jQuery and jQuery Mobile -->
    <script src="https://d10ajoocuyu32n.cloudfront.net/jquery-1.9.1.min.js"></script>
    <script src="https://d10ajoocuyu32n.cloudfront.net/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/util.js"></script>

    <script type="text/javascript">


        /*
         {
         id: <planId>,
         warningSigns: {
         item: ,
         item: ,
         item
         },
         selfCoping: {
         item: ,
         item:
         },
         copingOutside: {
         item: ,
         item
         }

         }
           */


        function onDeviceReady() {

            var personalContact = JSON.parse(window.localStorage.getItem("currentPersonalContact"));
            $('#contactName').append(personalContact.firstName + " " + personalContact.lastName );


            if (typeof(personalContact.cellPhoneNumber) != "undefined") {
                $("#personalContactContent").append(Util.createTelLinkListItem(personalContact.cellPhoneNumber, "CALL CELL", "b"));
            }
            if (typeof(personalContact.workPhoneNumber) != "undefined") {
                $("#personalContactContent").append(Util.createTelLinkListItem(personalContact.workPhoneNumber, "CALL WORK", "d"));
            }
            if (typeof(personalContact.address) != "undefined") {
                $("#personalContactContent2").append(Util.createGeoLinkListItem(personalContact.address, "VISIT", "e"));
            }

            $("#personalContactContent").listview("refresh");
            $("#personalContactContent2").listview("refresh");
        }


        function createTelLinkListItem(phNum, linkContent, dataTheme) {
            var url = "tel:" + phNum;
            return createLinkListItem(url, linkContent, dataTheme);
        }

        function createGeoLinkListItem(address, linkContent, dataTheme) {
            var addressString = encodeURI(address.address1 + ", " + address.address2 + ", " + address.city + ", " + address.state + " " + address.zip);
            var url = "geo:0,0?q=" + addressString;
            return createLinkListItem(url, linkContent, dataTheme);
        }

        function createLinkListItem(url, linkContent, dataTheme) {
            var content = "<a href='" + url + "'>" + linkContent + "</a>";
            return createListItem(content, dataTheme);
        }

        function createListItem  (content, dataTheme) {
            return "<li data-theme='" + dataTheme + "'>" + content + "</li>";
        }

        function onBodyLoad() {
            document.addEventListener("deviceready", onDeviceReady, false);
        }

        $(document).ready(onBodyLoad);

    </script>


</head>
<body>
<!-- Home -->
<div data-role="page" id="personalContactsPage">
    <div data-theme="a" data-role="header">
        <h3 id="contactName">

        </h3>
    </div>
    <div data-role="content">
        <ul data-role="listview" data-divider-theme="d" data-inset="true" id="personalContactContent">
        </ul>
    </div>

    <div data-role="content">
        <ul data-role="listview" data-divider-theme="d" data-inset="true" id="personalContactContent2">
        </ul>
    </div>

</div>

</body>
</html>
